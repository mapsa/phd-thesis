\chapter{OVECM}

\begin{landscape}
    \begin{tikzpicture}[node distance=2cm]
    \label{fig:pseudocodigo}
    \tiny
    %\node (start) [startstop] {Start};
    %\node (in1) [io, below of=start] {Input};
    \node (in1) [io] {Input: y, p, L, $\epsilon$, n};
    \node (pro1) [process, below of=in1] {$y_i = y[i:i+L]$};
    \node (dec1) [decision, below of=pro1, yshift=-0.5cm] {i = 0};
    \node (pro2a) [process, below of=dec1, yshift=-0.5cm] {$[\mathbf{A} \quad \mathbf{B}] =\texttt{ovecm}(\mathbf{y}_i,p,v,\mathbf{A},\mathbf{B})$
                                                        $\Delta \mathbf{Y}_{\text{true}}[i] = \mathbf{B}[-1,:]$
                                                        $\Delta \mathbf{Y}_{\text{pred}}[i] = \mathbf{A}[-1,:] \times \mathbf{X}$};

    \node (pro2b) [process, right of=dec1, xshift=4cm] {$v = \texttt{Johansen}(\mathbf{y}_i,p)$ $[\mathbf{A} \quad 
                                                                \mathbf{B}] = \texttt{vecm}(\mathbf{y}_i,p,v)$};
    \node (pro3) [process, below of=pro2a, yshift=-0.5cm] {$\mathbf{X} = \text{OLS} (\mathbf{A},\mathbf{B})$ \\
                                                        $\mathbf{y}_{\text{true}}[i] = \mathbf{y}_i[-n,:]$ \\
                                                        $\mathbf{y}_{\text{pred}}[i] = \mathbf{A}[-n,:] \times \mathbf{X} +$ \\$ \mathbf{y}_i[-n-1,:-1]$ \\
                                                        $e = \texttt{mape}(\mathbf{y}_{\text{true}}, \mathbf{y}_{\text{pred}})$};

    \node (dec2) [decision, below of=pro3, yshift=-0.5cm] { $e > \epsilon $ };

    \node (pro4a) [process, right of=dec2, xshift=4cm] {$v = \texttt{Johansen}(\mathbf{y}_i,p)$ \\
                                                        $\mathbf{A} = \texttt{uvecm}(\mathbf{y}_i,p,v,\mathbf{A})$ \\
                                                        $\mathbf{X} = \texttt{OLS} (\mathbf{A},\mathbf{B})$};

   
    \node (pro5) [process, left of=pro2a, xshift=-4cm] {$ i++ $}; 
   
    \node (dec3) [decision, below of=dec2, yshift=-0.5cm] { $i > it $ };
    
    \node (out1) [io, below of=dec3] {Output: $\Delta \mathbf{y}_{true}, \Delta \mathbf{y}_{pred}$};
    
    %\node (stop) [startstop, below of=out1] {Stop};
    
    %\draw [arrow] (start) -- (in1);
    \draw [arrow] (in1) -- (pro1);
    \draw [arrow] (pro1) -- (dec1);
    \draw [arrow] (dec1) -- node[anchor=east] {no} (pro2a);
    \draw [arrow] (dec1) -- node[anchor=south] {si} (pro2b);
    \draw [arrow] (pro2a) -- (pro3);
    \draw [arrow] (pro2b) |- (pro3);
    \draw [arrow] (pro3) -- (dec2);
    \draw [arrow] (dec2) --  node[anchor=south] {si} (pro4a);
    \draw [arrow] (pro4a) |- (dec3);
    
    \draw [arrow] (dec2) --  node[anchor=east] {no} (dec3);
    \draw [arrow] (dec3.west) -| node[anchor=east] {no} (pro5);
    \draw [arrow] (pro5) |- (pro1);
    \draw [arrow] (dec3) --  node[anchor=east] {si} (out1);
    %\draw [arrow] (out1) -- (stop);
    \end{tikzpicture}
\end{landscape}    